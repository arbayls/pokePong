<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <title>Pong</title>
    <script src="http://cdn.jsdelivr.net/phaser/2.5.0/phaser.min.js"></script>
    <link rel="stylesheet" type="text/css" href="styles.css">

    <script src="https://code.jquery.com/jquery-3.2.0.min.js"
    integrity="sha256-JAW99MJVpJBGcbzEuXk4Az05s/XyDdBomFqNlM3ic+I="
    crossorigin="anonymous"></script>

</head>

<body>
    <script type="text/javascript">

        $.getJSON('http://pokeapi.co/api/v2/item/poke-ball', function(data) {
            var pokeball = data.sprites.default;
            console.log(pokeball);
            pokePong(pokeball);
        });

        function pokePong(pokeball) {
          var game = new Phaser.Game(800, 600, Phaser.AUTO, '', {
              preload: preload,
              create: create,
              update: update
          });

          var background;

          var paddle1;
          var paddle2;
          var ball;

          var ballLaunched;
          var ballVelo;

          var score1;
          var score2;

          var score1keeper;
          var score2keeper;

          var bounced;

          function preload() {

              this.load.crossOrigin = "Anonymous";
              game.load.image('paddle',
                  'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAABCCAYAAABaQIagAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpMwidZAAAD3ElEQVRYCe2YW28bNxCFDy+7kiVLvqpIGwRJkLykKPrc//8L+taXNkCBtgFs2bruSnsh2TPcuE3kOKHqvBQQBa5W0sxZzqdZ7pDq4ofXYTB2GE8szr4zOH9icPF8hcnrCnk/IB8gtroEmkLj6m2Gm9+Pcfunw+xdi+V1jXKhYHXukQ0VBqcKo4nG+TOHFz9d4fx5DaUA2wtRqK0UQgsMvskR/BGaRqPaAJtCQZceFpaHgUHvROH4QuHpj1NMXlXQthvJ3TEK9oBLjrRa3WC9nGA51zAzIFBD532OZqhxfGIwOlN48ub2nsidmLwbXuDb72e0pc+poa8hAg171DcYitBYYzhWyAZdKB86755nw8ALa4xGAetjg2LAqLQNHBavRFa2v+vy8GfbdzDkJ77akKVXHkEHKBHc4fKwDKK98PXawylHMaopLbGTPs9Tm/hZ8dEKcq5zrZEZ0mfnaXITW0OFzPIf57tmanBIXwb86SuIn0fLN9t4nobATlZ8pTaxFT9Hv9ozjzRHIxkce6oK7ehCHxW74Qfd49HyC0PiezOiX0annqWvk7CoLkPlaXIT0y48wPkA21KlfR+rUEptHR/OCGTUUEjS4BGMhBVzSRjlkRHziPFq9tQmtoYKkoMfM2JUezOiTwyReCIjxzxwQRH6noyEL30bz3tNounyQeJNb2IbfSMjYskZZ5dH/51RLvfpP3kkjNIHFG2F6Q4juWe6eydV605gh9FdvKkyHc8Do8/zOuTR5/nIrwdGB0b35+zDfPRBVvzf5uw9Hmxi+onn2ld79n+1PHpcfXT/2f8YRo2TYvJxjGrHOrt7fsscLK/0Fudsmsuqo6shpQ6kWqyzRTWxxRqStbnU2ZGRrCM4G7DekTo7XUhsw/tSSEps2zFifcRaWe6f1BbvNZpLfRQZ6TgWcU8fzb8X60h1axEy4morUt8Hd1eoS/5xvUZOXQ3JkAJD25sRw/L0Eyy6Ju2WvWn4hZBPbOIjvk3rUJG2Do6FuiNoLiVdm87J01Z8pIuG1fwbFbcn0Cg4blukNldpqJohteREDV1XHlvucZRr7nOsqLf9spjYbFYh+mxLhkgNXW481muPxdxheQtc/3ZEgA+PS367+rWPxU3AfNZiVTgUpYN1tULNk2KusJwCf/x8yTXGGpcvZ8iOPobfbBSmb09pM4y2xZywC97w1LC6NXDctqkXQDENmGYjshqiWlj0x7K278QcZ4kt94ne/XKG2V8a5bVDs+A/vQkwjps+lQAmH2UaHiQVLLalwvrmAn3uK9m8E2prCq0DVjP2qcPqusHqtkFJVhWZ/Q2HleaRQRaZtgAAAABJRU5ErkJggg=='
              );

              // game.load.image('ball',
              //     'data:image/png;base64,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'
              // );
              game.add.image('ball', pokeball);
          }

          function create() {

              paddle1 = makePaddle(8, game.world.centerY);
              paddle2 = makePaddle(game.world.width - 8, game.world.centerY);
              ball = createBall(game.world.centerX, game.world.centerY);

              ballLaunched = false;
              ballVelo = 400;

              game.input.onDown.add(launcher, this);

              score1 = game.add.text(130,128,'0',{font: "64px Gabriella", fill: '#ffffff',
              align: 'center'
              });

              score2 = game.add.text(game.world.width -130,128,'0',{font: "64px Gabriella", fill: '#ffffff',
              align: 'center'
              });

              score1keeper = 0;
              score2keeper = 0;

              bounced = 0;

          }

          function update() {

            score1keeper.text = score1;
            score2keeper.text = score2;


              controlPaddle(paddle1, game.input.y);
              if (bounced > 0) {
                bounced--;
              }
              if ((checkOverlap(paddle1, ball) || checkOverlap(paddle2, ball)) && bounced === 0) {
                ball.body.velocity.x -= 2 * ball.body.velocity.x
                bounced = 10
              }

              if (ball.body.blocked.left) {
                  score2 += 1;
                  console.log("player 2 scores!");
              } else if (ball.body.blocked.right) {
                  score1 += 1;
                  console.log("player 1 scores!");
              }

              paddle2.body.velocity.setTo(ball.body.velocity.y);
              paddle2.body.velocity.x = 0;
              paddle2.body.maxVelocity.y = 400;

          }

          function makePaddle(x, y) {
              var paddle = game.add.sprite(x, y, 'paddle');
              // paddle.body.enable = true;
              paddle.anchor.setTo(0.5);
              game.physics.arcade.enable(paddle);
              paddle.body.collideWorldBounds = true;
              paddle.body.immoveable = true;
              paddle.scale.setTo(2, 2);

              return paddle;
          }

          function controlPaddle(paddle, y) {
              paddle.y = y;

              if (paddle.y < paddle.height / 2) {
                  paddle.y = (paddle.height / 2);
              } else if (paddle.y > game.world.height - paddle.height / 2) {
                  paddle.y = game.world.height - paddle.height / 2;
              }

          }

          function createBall(x, y) {
              var ball = game.add.sprite(x, y, 'ball');
              ball.anchor.setTo(0.5);
              game.physics.arcade.enable(ball);
              ball.body.collideWorldBounds = true;
              ball.body.bounce.setTo(1, 1);
              ball.body.mass= .7;
              ball.body.immoveable = true;

              return ball;
          }

          function launcher() {
              if (ballLaunched) {
                  ball.x = game.world.centerX;
                  ball.y = game.world.centerY;
                  ball.body.velocity.setTo(0, 0);
                  ballLaunched = false;
              } else {
                  ball.body.velocity.x = -ballVelo;
                  ball.body.velocity.y = ballVelo;
                  ballLaunched = true;
              }
          }

          function checkOverlap(paddle, ball) {
              var boundsA = ball.getBounds();
              var boundsB = paddle.getBounds();

              console.log(Phaser.Rectangle.intersects(boundsA, boundsB));
              return Phaser.Rectangle.intersects(boundsA, boundsB);
            }

        }

    </script>
</body>

</html>
